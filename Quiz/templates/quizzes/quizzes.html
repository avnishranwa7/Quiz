{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="{% static 'templates/quizzes/css/quizzes.css' %}"> 
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <title>My Quizzes</title>
        
        <script type="text/javascript">
          window.history.forward();
          function noBack() {
              window.history.forward();
          }
      </script>
      <!-- <script>
        endtime = function(end_time){
            // console.log(typeof(endtime));
            // var countDownDate = new Date();
            // var time = new Date();
            // countDownDate.setTime(time.getTime() + (duration * 60 * 1000));
            // countDownDate = countDownDate.getTime();
            console.log(end_time);
            // return countDownDate;
        }
      </script> -->
      <script>
        endtime = function(duration, end_time, date){
          var countDownDate = new Date();
          var time = new Date();
          countDownDate.setTime(time.getTime() + (duration * 60 * 1000));
          countDownDate = countDownDate.getTime();
          var l = end_time.length;
          var x = end_time.slice(l-4, l);
          var empty = '';
          if(x=='a.m.'){
            end_time = end_time.slice(0, l-4) + 'am';
          }
          else{
            end_time = end_time.slice(0, l-4) + 'pm';
          }
          var newdate = new Date(date+' '+end_time);
          return Math.min(newdate, countDownDate);
        }
      </script>
    </head>
    <body>
        {% csrf_token %}
        <div class='first' style="color: darkslategray;">
            <a href = 'http://127.0.0.1:8000/courses/{{rollno}}'><h1 style="color: darkslategray;">Quizze</h1></a>
            <p>THE WORLD'S FAVOURITE QUIZ SITE</p>
        </div>
        <div class='second'>
            <div style="color: white;">My Quizzes</div>
        </div>
        {% for i in bool %}
        <div class="container" style = "padding-top: 10px;">
            <div class="panel-group" id="accordion">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse{{forloop.counter}}">Quiz ID: {{i.0.quiz_id}}</a>
                  </h4>
                </div>
                <div id="collapse{{forloop.counter}}" class="panel-collapse collapse in">
                  <div class="panel-body" style="font-size: 18px;">
                    Quiz Name: {{i.0.quiz_name}}
                    <br>
                    Course: {{i.0.Course_ID.Course_Name}}
                    <br>
                    Date: {{i.0.date}}
                    <br>
                    Available: {{i.0.start_time}} - {{i.0.end_time}}
                    <br>
                    Duration: {{i.0.duration}}
                    {% ifequal i.1 'active' %}
                    <button class = "btn success"  onclick="location.href = 'http://127.0.0.1:8000/test/{{rollno}}/{{i.0.quiz_id}}/'+endtime({{i.0.duration}},'{{i.0.end_time}}', '{{i.0.date}}') ">Take Quiz</button>
                    {% endifequal %}
                    {% ifequal i.1 'locked' %}
                    <button class = "btn success">Quiz Locked</button>
                    {% endifequal %}
                    {% ifequal i.1 'over' %}
                    <button class = "btn success" onclick="location.href = 'http://127.0.0.1:8000/result/{{rollno}}/{{i.0.quiz_id}}'">Check Result</button>
                    {% endifequal %}
                  </div>
                </div>
              </div>
              
            </div> 
        </div>
        {% endfor %}
    </body>
</html>